from flask import Flask, request, jsonify
import os

app = Flask(__name__)

@app.route('/scan', methods=['POST'])
def scan():
    try:
        directory_path = request.json.get('directory_path')
        
        if not os.path.exists(directory_path):
            return jsonify({'error': f'Directory {directory_path} does not exist.'}), 404
        
        files_and_directories = os.listdir(directory_path)
        
        sensitive_items = []
        for item in files_and_directories:
            if item.startswith('password') or item.endswith('.conf'):
                sensitive_items.append(item)
        
        if sensitive_items:
            return jsonify({'vulnerability': 'LLM Injection detected', 'sensitive_items': sensitive_items}), 200
        else:
            return jsonify({'message': 'No LLM Injection detected'}), 200
    
    except Exception as e:
        return jsonify({'error': str(e)}), 500

if __name__ == '__main__':
    app.run(debug=True, port=1337)
