import requests

def check_css_injection(url):
    json_payload = {
        "url": url,
        "payloads": [
            "<style>body{background-image:url('javascript:alert(\"CSS Injection\")')}</style>"
        ],
        "method": "GET"
    }
    response = requests.post("http://localhost:1337", json=json_payload)
    
    if response.status_code == 200:
        try:
            result = response.json()
            if result.get("vulnerabilities"):
                print("CSS Injection Vulnerability Found!")
            else:
                print("No CSS Injection Vulnerability Detected.")
        except ValueError:
            print("Error: Invalid JSON response from the server.")
    else:
        print("Failed to check for CSS Injection Vulnerability.")
        print("Response content:", response.content)

def send_csp_protected_request(url):
    headers = {
        "Content-Security-Policy": "default-src 'self'; style-src 'self' 'unsafe-inline';"
    }
    response = requests.get(url, headers=headers)
    if response.ok:
        print("Request sent successfully with CSP headers.")
    else:
        print(f"Failed to send request to {url}.")

# Example usage
url = "http://example.com"
check_css_injection(url)
send_csp_protected_request(url)
