import requests

def check_css_injection(url):
    json_payload = {
        "url": url,
        "payloads": [
            "<style>body{background-image:url('javascript:alert(\"CSS Injection\")')}</style>"
        ],
        "method": "GET"
    }

def send_csp_protected_request(url):
    response = requests.get(url)
    if response.ok:
        csp_header = response.headers.get("Content-Security-Policy")
        if csp_header:
            # Check if 'self' is included in the style-src directive
            if "'self'" not in csp_header or "style-src" not in csp_header:
                print("Possible CSS Injection Vulnerability found.")
            else:
                print("No CSS Injection Vulnerability Detected.")
        else:
            print("No CSP header found.There might be vulnerability chances")
    else:
        print(f"Failed to send request to {url}.")


# Example usage
url = "http://localhost:1337"
check_css_injection(url)
send_csp_protected_request(url)
